Data structures and algorithms for Prime game